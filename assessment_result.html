<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultado da Avaliação</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* Added to constrain radar chart height */
        #radarChartContainer {
            max-height: 400px;
            /* Adjust as needed */
            overflow: hidden;
        }
    </style>
    <script>
        async function handleLogout() {
            try {
                await auth.signOut();
                window.location.href = 'index.html';
            } catch (error) {
                console.log(error.message);
            }
        }

        async function handleHome() {
            try {
                window.location.href = 'dashboard.html';
            } catch (error) {
                console.log(error.message);
            }
        }
    </script>
</head>

<body>
    <div id="menu-button-container">
        <button id="menu-icon-button" onclick="handleHome()" style="position:absolute; top:24px; left:24px;">
            <i class="material-icons">home</i>
            <span class="tooltip">Início</span>
        </button>
    </div>

    <div id="logout-button-container">
        <button id="logout-icon-button" onclick="handleLogout()" style="position:absolute; top:24px; right:24px;">
            <i class="material-icons">logout</i>
            <span class="tooltip">Sair</span>
        </button>
    </div>
    <div class="container">
        <div id="results-container">
            <h2 id="final-message-title"></h2>
            <p id="final-message"></p>
            <div id="radarChartContainer">
                <canvas id="radarChart" width="400" height="400" style="max-width: 600px;"></canvas>
            </div>
            <h2 id="total-result-title"></h2>
            <p id="total-result" style="font-weight: 600;"></p>
            <p id="total-result-interpretation"></p>
            <div id="section-results">
            </div>
            <p id="final-reflection"></p>
            <!-- <button id="share-button" style="margin-top:32px;">Compartilhar no WhatsApp</button>
            <button id="save-results-button" style="margin-top:16px;">Baixar PDF</button>-->

        </div>
    </div>
    <script src="assessment2.js"></script>
    <script src="indice-networking-interno.js"></script>
    <!-- Load the same assessment script -->
    <script>
        // Firebase Configuration and Initialization (SAME as in dashboard.html)
        const firebaseConfig = {
            apiKey: "AIzaSyDFAh_QfHaQqXIna07yHuHzN6EW4mGCtUE",
            authDomain: "chartme-2c4aa.firebaseapp.com",
            projectId: "chartme-2c4aa",
            storageBucket: "chartme-2c4aa.firebasestorage.app",
            messagingSenderId: "1000796548418",
            appId: "1:1000796548418:web:c891c61205cdf404f1ecdb",
            measurementId: "G-T2686T1ETY"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        document.addEventListener('DOMContentLoaded', () => {
            // Get the save button
            const saveResultsButton = document.getElementById('save-results-button');

            //Event Listener
            if (saveResultsButton) {
                saveResultsButton.addEventListener('click', () => {
                    const urlParams = new URLSearchParams(window.location.search);
                    const assessmentId = urlParams.get('assessmentId');
                    loadAssessmentDetailsToGeneratePDF(assessmentId); // Pass assessmentId
                });
            }

            const urlParams = new URLSearchParams(window.location.search);
            const assessmentId = urlParams.get('assessmentId');
            if (assessmentId) {
                loadAssessmentDetails(assessmentId);
            } else {
                document.getElementById('results-container').innerText = 'Assessment ID not found in URL.';
            }
        });

        async function loadAssessmentDetails(assessmentId) {
            try {
                const docRef = db.collection("assessmentHistory").doc(assessmentId);
                const doc = await docRef.get();

                if (doc.exists) {
                    const assessment = doc.data();
                    displayAssessmentDetails(assessment);
                } else {
                    document.getElementById('results-container').innerText = 'Assessment not found.';
                }
            } catch (error) {
                console.error("Error loading assessment details:", error);
                document.getElementById('results-container').innerText = 'Error loading assessment details.';
            }
        }

        async function loadAssessmentDetailsToGeneratePDF(assessmentId) {
            try {
                const docRef = db.collection("assessmentHistory").doc(assessmentId);
                const doc = await docRef.get();

                if (doc.exists) {
                    const assessment = doc.data();
                    generatePDF(auth.currentUser.uid, assessment.answers, assessment.result, assessment.resultInterpretation, assessment.assessmentName);
                } else {
                    document.getElementById('results-container').innerText = 'Assessment not found.';
                }
            } catch (error) {
                console.error("Error loading assessment details:", error);
                document.getElementById('results-container').innerText = 'Error loading assessment details.';
            }
        }

        async function displayAssessmentDetails(assessment) {
            const finalMessageTitle = document.getElementById("final-message-title");
            const finalMessage = document.getElementById("final-message");
            const totalResultTitle = document.getElementById("total-result-title");
            const totalResult = document.getElementById("total-result");
            const totalResultInterpretation = document.getElementById("total-result-interpretation");
            const sectionResultsDiv = document.getElementById("section-results");
            const finalReflection = document.getElementById('final-reflection');

            // Set static content based on assessment type
            let assessmentType = '';
            let sectionLabels = [];
            let sectionsConfig = [];

            if (assessment.assessmentName === "Fórmula do Networking") {
                assessmentType = 'fn';
                totalResult.innerText = `${assessment.result} de 60 pontos possíveis`;
                sectionLabels = ['Proximidade', 'Frequência', 'Sintonia de interesses'];
                sectionsConfig = [
                    {
                        title: "1. PROXIMIDADE", questions: [{}, {}, {}, {}, {}]
                    },
                    {
                        title: "2. FREQUÊNCIA", questions: [{}, {}, {}, {}, {}]
                    },
                    {
                        title: "3. SINTONIA DE INTERESSES", questions: [{}, {}, {}, {}, {}]
                    }
                ];

                finalMessageTitle.innerText = "FN - Fórmula do Networking";
                finalMessage.innerHTML = `Analise cuidadosamente seus resultados. Eles oferecem um panorama claro sobre a <strong>maturidade da sua relação de networking</strong>, ajudando a compreender como essa conexão se desenvolve e onde há espaço para crescimento. Identifique os pontos fortes que tornam essa relação valiosa, mas também reconheça os aspectos que podem ser aprimorados. Você é plenamente capaz de evoluir, se adaptar e aprender. Hoje praticar networking não é mais apenas um complemento, é uma necessidade premente.
        <br>Lembre-se: este é um retrato do momento, não um diagnóstico definitivo sobre a qualidade dessa conexão. As relações evoluem e, com pequenas ações intencionais, é possível fortalecer laços, criar maior alinhamento e transformar conexões em oportunidades significativas.
        <blockquote cite="https://www.linkedin.com/in/paulocruzfilho">"Networking é a ciência, a arte e a prática do relacionamento profissional."</blockquote><address> - Paulo Cruz, fundador do Inner Networking.</address>
        <br>O <strong>Fórmula do Networking (FN)</strong> reflete o equilíbrio entre <strong>Proximidade, Frequência e Sintonia de Interesses</strong>, três dimensões essenciais para avaliar a profundidade e o impacto de uma conexão profissional. Sua pontuação final, resultante da soma desses fatores, indica o nível de maturidade dessa relação e o quanto ela contribui para seu crescimento profissional.
        <br><p class="FNequation"></p>
        <ul>
        <li><strong>Uma pontuação alta</strong> sugere que essa é uma conexão bem estabelecida, com interações significativas, frequentes e alinhadas.</li>
        <li><strong>Uma pontuação intermediária</strong> aponta para uma relação existente, mas que pode ser fortalecida com ajustes específicos.</li>
        <li><strong>Uma pontuação baixa</strong> indica que essa conexão pode estar enfraquecida, seja por falta de interação, desalinhamento de interesses ou ausência de um vínculo consistente.</li>
        </ul>
        A seguir, veja a interpretação detalhada do seu resultado e como utilizá-lo para aprimorar sua abordagem no networking.`;

                finalReflection.innerHTML = `<h3>REFLEXÃO FINAL</h3><br>
        As conexões profissionais não são estáticas – elas evoluem conforme o tempo, as interações e o valor que cada parte deposita na relação. A Fórmula do Networking (FN) oferece um diagnóstico do momento, mas a construção e a manutenção de relações de qualidade são processos contínuos, que dependem de intenção, consistência e autenticidade. Como próximos passos:
        <ul>
        <li>Reflita sobre suas relações estratégicas: Quais conexões você quer fortalecer? Quais precisam de mais atenção?</li>
        <li>Defina pequenas ações: Um simples contato, um convite para um café ou um compartilhamento de oportunidade podem reativar laços valiosos.</li>
        <li>Expanda sua mentalidade de networking: Construir relações maduras e produtivas leva tempo. Invista de forma intencional, autêntica e estratégica.</li>
        </ul>
        <strong>Lembre-se: seu potencial de Networking não é estático; ele pode ser moldado e aprimorado com dedicação, prática e estratégia.</strong>Use essas informações como uma bússola para fortalecer seus pontos fortes e trabalhar nas áreas que chamam mais atenção. Ao fazer isso, você não apenas aprimorará seu desempenho em networking, mas também abrirá portas para <strong>avanços inovadores em sua carreira</strong> e para a construção de relacionamentos profissionais sólidos e enriquecedores.
        <blockquote cite="https://www.linkedin.com/in/paulocruzfilho">“Seus conhecimentos e habilidades abrem portas, mas são seus relacionamentos que dirão até onde você pode ir.”</blockquote><address> - Paulo Cruz, fundador do Inner Networking.</address><br>
        Boa sorte em sua jornada de crescimento profissional!
        <br><br>
        Para saber mais sobre a FN (Fórmula do Networking), você pode acessar os materiais de aprofundamento gratuitos no site <a href="https://www.innernetworking.com.br" target="_blank">www.innernetworking.com.br</a>. Além disso, caso seja do seu interesse, você pode obter uma versão detalhada do seu resultado e mesmo desenvolver o seu Desafio Perfeito para dar um salto evolutivo em seu nível de networking.
        <br><br>
        Caso deseje adquirir a análise de perfil completa, entre em contato conosco no site <a href="https://www.innernetworking.com.br" target="_blank">www.innernetworking.com.br</a>`;

            } else if (assessment.assessmentName === "Índice de Magnetismo Profissional") {
                assessmentType = 'imp';
                totalResult.innerText = `${assessment.result} de 100 pontos possíveis`;
                sectionLabels = ['Agradabilidade', 'Expertise', 'Confiança', 'Colaboração', 'Visibilidade'];
                sectionsConfig = [
                    {
                        title: "1. AGRADABILIDADE", questions: [{}, {}, {}, {}, {}]
                    },
                    {
                        title: "2. EXPERTISE", questions: [{}, {}, {}, {}, {}]
                    },
                    {
                        title: "3. CONFIANÇA", questions: [{}, {}, {}, {}, {}]
                    },
                    {
                        title: "4. COLABORAÇÃO", questions: [{}, {}, {}, {}, {}]
                    },
                    {
                        title: "5. VISIBILIDADE", questions: [{}, {}, {}, {}, {}]
                    }
                ];

                finalMessageTitle.innerText = "IMP - Índice de Magnetismo Profissional";
                finalMessage.innerHTML = `Analise cuidadosamente seus resultados. Eles mostram um panorama de suas habilidades atuais no mundo do networking, considere a presença que você entrega em tudo o que faz. Enxergue seus pontos fortes e célebres, mas também não ignore as áreas que indicam espaço para crescimento. Entenda que esta avaliação é plenamente capaz de evoluir, de adaptar se e aprender. Hoje praticar networking não é mais apenas um complemento, é uma necessidade premente.<br>
    <blockquote cite="https://www.linkedin.com/in/paulocruzfilho">“Hoje, praticar networking não é mais apenas um complemento, mas uma necessidade essencial para o desenvolvimento pessoal e profissional.</blockquote><address> - Paulo Cruz, fundador do Inner Networking.</address><br>
    De forma geral, o Índice de Magnetismo Profissional (IMP) do seu Networking reflete o desempenho integrado das cinco dimensões essenciais – Agradabilidade, Expertise, Confiança, Colaboração e Visibilidade – que compõem a sua capacidade de estabelecer conexões valiosas no ambiente profissional. A pontuação final, obtida pela soma dos pontos de cada dimensão, indica o quão eficazmente você se posiciona, comunica suas competências e constrói relacionamentos sólidos. Uma pontuação elevada sugere que você possui habilidades robustas de networking, abrindo portas para novas oportunidades e associações estratégicas. Por outro lado, uma pontuação mais baixa sinaliza áreas de desenvolvimento que, quando aperfeiçoadas, podem potencializar seu magnetismo profissional e profissional. Analise os resultados abaixo para identificar seus pontos fortes e as oportunidades de melhoria, e use essas informações para direcionar seu autodesenvolvimento e melhorar suas práticas de networking. O seu resultado final foi de:`;

                finalReflection.innerHTML = `<h3>APROFUNDAMENTO</h3><br>
        Para saber mais sobre o seu IMP (Índice de Magnetismo Profissional), você pode acessar os materiais de aprofundamento gratuitos no site
        <a href="https://www.innernetworking.com.br" target="_blank">www.innernetworking.com.br</a>.
        Além disso, caso seja do seu interesse, você pode obter uma versão detalhada do seu IMP e mesmo desenvolver o seu Desafio Perfeito para dar um salto evolutivo em seu nível de networking.<br>

        <h3>REFLEXÃO FINAL</h3><br>

        Lembre-se: seu potencial de Networking não é estático; ele pode ser moldado e aprimorado com dedicação, prática e estratégia. Use essas informações como uma bússola para fortalecer seus pontos fortes e trabalhar nas áreas que chamam mais atenção. Ao fazer isso, você não apenas aprimorará seu desempenho em networking, mas também abrirá portas para avanços inovadores em sua carreira e para a construção de relacionamentos profissionais sólidos e enriquecedores.<br>

        <blockquote cite="https://www.linkedin.com/in/paulocruzfilho">“Seus conhecimentos e habilidades abrem portas, mas são seus relacionamentos que dirão até onde você pode ir.”</blockquote><address> - Paulo Cruz, fundador do Inner Networking.</address><br>

        Boa sorte em sua jornada de crescimento profissional!`;
            

            } else if (assessment.assessmentName === "Índice de Networking Interno") {
                            assessmentType = 'ini';
                            totalResult.innerText = `${assessment.result} de 80 pontos possíveis`;
                            sectionLabels = ['Relacionamento Próximo', 'Constância de Fomento', 'Alinhamento de Interesses', 'Atuação Estratégica'];
                            sectionsConfig = [
                                {
                                    title: "1. RELACIONAMENTO PRÓXIMO", questions: [{}, {}, {}, {}, {}]
                                },
                                {
                                    title: "2. CONSTÂNCIA DE FOMENTO", questions: [{}, {}, {}, {}, {}]
                                },
                                {
                                    title: "3. ALINHAMENTO DE INTERESSES", questions: [{}, {}, {}, {}, {}]
                                },
                                {
                                    title: "4. ATUAÇÃO ESTRATÉGICA", questions: [{}, {}, {}, {}, {}]
                                }
                            ];

                            finalMessageTitle.innerText = "INI - Índice de Networking Interno";
                            finalMessage.innerHTML =
                            `Analise cuidadosamente seus resultados. Eles mostram um panorama de suas habilidades atuais de networking dentro da organziação onde você atua. Considere a presença que você entrega em tudo o que faz. Enxergue seus pontos fortes e célebres, mas também não ignore as áreas que indicam espaço para crescimento. Entenda que esta avaliação é um retrato do momento, não um veredito final. Você é plenamente capaz de evoluir, se adaptar e aprender. Atualmente, praticar networking não é mais apenas um complemento, é uma necessidade premente.
                            <blockquote cite="https://www.linkedin.com/in/paulocruzfilho">"Hoje, praticar networking não é mais apenas um complemento mas uma necessidade essencial para o desenvolvimento pessoal e profissional."</blockquote><address> - Paulo Cruz, fundador do Inner Networking.</address>
                            <br>De forma geral, o <strong>Índice de Networking Interno (INI)</strong> reflete o desempenho integrado das quatro dimensões essenciais – Relacionamento Próximo (RP), Constância de Fomento (CF), Alinhamento de Interesses (AI) e Atuação Estratégica (AE) – que compõem a sua capacidade de estabelecer conexões valiosas no ambiente profissional dentro da organização. A pontuação final, obtida pela soma dos pontos de cada dimensão, indica o quão eficazmente você se relaciona, se posiciona, comunica suas competências e constrói relacionamentos sólidos. Uma pontuação elevada sugere que você possui habilidades robustas de networking interno, abrindo portas para novas oportunidades dentro da própria organização e tendo abertura para parcerias estratégicas com pessoas das mais variadas áreas organizacionais. Por outro lado, uma pontuação mais baixa sinaliza áreas de desenvolvimento que, quando aprimoradas, podem potencializar sua reputação e performance pessoal e profissional. Analise os resultados abaixo para identificar seus pontos fortes e as oportunidades de melhoria, e use essas informações para direcionar seu autodesenvolvimento e aprimorar suas práticas de networking interno.`;

                            finalReflection.innerHTML = `<h3>REFLEXÃO FINAL</h3><br>
                            <strong>Lembre-se: sua maturidade de Networking Interno não é estática; ela pode ser moldada e aprimorada com dedicação, prática e estratégia.</strong> Use essas informações como uma bússola para fortalecer seus pontos fortes e trabalhar nas áreas que chamam mais atenção. Ao fazer isso, você não apenas aprimorará seu desempenho em networking interno, mas também abrirá portas para avanços inovadores em sua carreira e para a construção de relacionamentos profissionais sólidos e enriquecedores.
                            <blockquote cite="https://www.linkedin.com/in/paulocruzfilho">“Seus conhecimentos e habilidades abrem portas, mas são seus relacionamentos que dirão até onde você pode ir.”</blockquote><address> - Paulo Cruz, fundador do Inner Networking.</address><br>
                            Boa sorte em sua jornada de crescimento profissional!
                            <br><br>
                            Para saber mais sobre a INI (Índice de Networking Interno), você pode acessar os materiais de aprofundamento gratuitos no site <a href="https://www.innernetworking.com.br" target="_blank">www.innernetworking.com.br</a>. Além disso, caso seja do seu interesse, você pode obter uma versão detalhada do seu INI e mesmo desenvolver o seu Desafio Perfeito para dar um salto evolutivo em seu nível de networking interno.
                            <br><br>
                            Caso deseje adquirir a análise de perfil completa, entre em contato conosco no site <a href="https://www.innernetworking.com.br" target="_blank">www.innernetworking.com.br</a>`;
          
                        }



            totalResultTitle.innerText = "Seu índice total foi de:";


            // Access the correct interpretation string from totalResultInterpretations
            if (assessment.resultInterpretation && totalResultInterpretations[assessment.resultInterpretation]) {
                totalResultInterpretation.innerText = totalResultInterpretations[assessment.resultInterpretation];
            } else {
                totalResultInterpretation.innerText = "Interpretação não disponível";
            }

            // Calculate scores based on the assessment type
            const sectionScores = calculateScoresFromAnswers(assessment.answers, assessmentType);

            // Generate Radar Chart
            generateRadarChart(sectionScores, sectionLabels);

            // Display Section Results
            displaySectionResults(sectionResultsDiv, sectionsConfig, assessment, sectionScores, assessmentType);

           document.getElementById('save-results-button').addEventListener('click', () => {
                generatePDF(auth.currentUser.uid, assessment.answers, assessment.result, assessment.resultInterpretation, assessmentType);
            });

        }

        function calculateScoresFromAnswers(answers, assessmentType) {
    const sectionScores = [];
    let sectionsConfig = [];

    if (assessmentType === 'fn') {
        sectionsConfig = [
            { title: "1. PROXIMIDADE", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "2. FREQUÊNCIA", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "3. SINTONIA DE INTERESSES", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] }
        ];
    } else if (assessmentType === 'imp') {
        sectionsConfig = [
            { title: "1. AGRADABILIDADE", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "2. EXPERTISE", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "3. CONFIANÇA", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "4. COLABORAÇÃO", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "5. VISIBILIDADE", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] }
        ];
    } else if (assessmentType === 'ini') {
        sectionsConfig = [
            { title: "1. RELACIONAMENTO PRÓXIMO", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "2. CONSTÂNCIA DE FOMENTO", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "3. ALINHAMENTO DE INTERESSES", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] },
            { title: "4. ATUAÇÃO ESTRATÉGICA", questions: Array(5).fill({}), options: ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"] }
        ];
    }

    sectionsConfig.forEach((section, sectionIndex) => {
        let sectionScore = 0;
        for (let i = 0; i < section.questions.length; i++) {
            const answerIndexForQuestion = sectionIndex * section.questions.length + i;
            const answer = answers.find(ans => ans.questionIndex === answerIndexForQuestion);
            if (answer) {
                sectionScore += (4 - answer.answerIndex);
            }
        }
        sectionScores.push(sectionScore);
    });

    return sectionScores;
}

        function generateRadarChart(sectionScores, sectionLabels) {
            const ctxRadar = document.getElementById('radarChart').getContext('2d');
            const newChart = new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: sectionLabels,
                    datasets: [{
                        label: 'Pontos',
                        data: sectionScores,
                        fill: true,
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderColor: 'rgb(255, 99, 132)',
                        pointBackgroundColor: 'rgb(255, 99, 132)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(255, 99, 132)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            min: 0,
                            max: 20,
                            ticks: {
                                stepSize: 4
                            }
                        }
                    },
                    elements: {
                        line: {
                            borderWidth: 3
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

        }

        function displaySectionResults(sectionResultsDiv, sections, assessment, sectionScores, assessmentType) {
            sectionResultsDiv.innerHTML = "";

            let sectionConfigs = [];
            let questions = [];

            if (assessmentType === 'fn') {
                sectionConfigs = [
                    { title: "1. PROXIMIDADE", questions: [{}, {}, {}, {}, {}] },
                    { title: "2. FREQUÊNCIA", questions: [{}, {}, {}, {}, {}] },
                    { title: "3. SINTONIA DE INTERESSES", questions: [{}, {}, {}, {}, {}] }
                ];

                questions = [
                    "Busca ativa por interações presenciais:<br>Com que frequência você cria oportunidades para interações presenciais com essa pessoa, demonstrando interesse genuíno na relação?",
                    "Profundidade das conversas:<br>Quão significativas são suas interações com essa pessoa?",
                    "Uso de canais digitais para manter o vínculo:<br>Com que frequência você utiliza o digital para manter contato com essa pessoa?",
                    "Disponibilidade e suporte ativo:<br>Com que frequência você se coloca à disposição para apoiar essa pessoa?",
                    "Interesse genuíno e reciprocidade na relação:<br>Como você percebe o equilíbrio e a reciprocidade na iniciativa de manter contato nessa relação?",
                    "Regularidade das interações:<br>Com que frequência você mantém contato ativo com essa pessoa?",
                    "Tempo de Duração da Relação:<br>Essa relação tem se mantido ativa ao longo do tempo, ou é algo recente ou passageiro?",
                    "Retomada da conexão após períodos sem contato:<br>Quando há um tempo sem contato, como você age?",
                    "Evolução da relação ao longo do tempo:<br>Como essa relação tem se desenvolvido?",
                    "Impacto da relação no seu desenvolvimento:<br>Essa conexão tem trazido benefícios para você e para a outra pessoa?",
                    "Alinhamento de interesses:<br>O quanto essa relação se baseia em interesses ou objetivos profissionais em comum?",
                    "Troca de informações e oportunidades:<br>Essa relação envolve troca mútua de informações e oportunidades?",
                    "Confiança e transparência na relação:<br>Você sente que há confiança mútua e abertura para compartilhar desafios e oportunidades?",
                    "Grau de colaboração e suporte mútuo:<br>O quanto essa relação envolve apoio mútuo e colaboração?",
                    "Visão de futuro na relação:<br>Você enxerga essa conexão como uma relação que pode gerar benefícios no longo prazo?"
                ];

            } else if (assessmentType === 'imp') {
                sectionConfigs = [
                    { title: "1. AGRADABILIDADE", questions: [{}, {}, {}, {}, {}] },
                    { title: "2. EXPERTISE", questions: [{}, {}, {}, {}, {}] },
                    { title: "3. CONFIANÇA", questions: [{}, {}, {}, {}, {}] },
                    { title: "4. COLABORAÇÃO", questions: [{}, {}, {}, {}, {}] },
                    { title: "5. VISIBILIDADE", questions: [{}, {}, {}, {}, {}] }
                ];

                questions = [
                    "Receptividade, atenção e compreensão para com os outros:<br> Como você avalia sua capacidade de demonstrar receptividade, atenção e compreensão ao interagir com as pessoas, independentemente de cargo ou status?",
                    "Abordagem e início de conversas:<br>Como você avalia sua habilidade para se aproximar e iniciar conversas de forma espontânea e construtiva, tanto com pessoas conhecidas quanto desconhecidas?",
                    "Atenção ao escutar:<br>Como você avalia sua capacidade de ouvir atentamente, demonstrando interesse genuíno durante a comunicação?",
                    "Estabelecimento de vínculos:<br>Como você avalia sua habilidade para criar e manter vínculos sólidos e produtivos, especialmente no ambiente profissional?",
                    "Adaptação a diferentes públicos:<br>Como você avalia sua capacidade de se adaptar e interagir de forma eficaz com diferentes públicos e em variados contextos?",
                    "Aplicação de habilidades cognitivas, técnicas e comportamentais:<br>Como você avalia sua capacidade de aplicar suas habilidades cognitivas, técnicas e comportamentais para gerar inovações, melhorar processos, atingir objetivos e superar desafios?",
                    "Busca por conhecimento e atualização:<br>Como você avalia sua iniciativa em buscar novos conhecimentos e se manter atualizado(a) na sua área de atuação?",
                    "Uso do compartilhamento para potencializar meus conhecimentos e experiências:<br>Como você avalia a frequência e a eficácia com que compartilha seus conhecimentos e experiências para fortalecer sua relevância e contribuir para sua área?",
                    "Responsabilidade e cumprimento de compromissos, metas e resultados:<br>Como você avalia sua capacidade de assumir e cumprir metas e compromissos, garantindo a responsabilidade pelos resultados obtidos?",
                    "Proatividade na aprendizagem e autodesenvolvimento:<br>omo você avalia sua iniciativa para buscar oportunidades de aprendizagem e se desenvolver continuamente, aprimorando suas habilidades e competências?",
                    "Coerência entre palavra e ação:<br>Como você avalia sua capacidade de honrar promessas, acordos, responsabilidades e compromissos, mantendo uma postura aberta e transparente mesmo diante de dificuldades?",
                    "Estabelecimento de relacionamentos confiáveis:<br>Como você avalia sua capacidade de construir e manter relacionamentos baseados em transparência, respeito e confiança mútua?",
                    "Manutenção da confidencialidade ao lidar com informações reservadas:<br>Como você se posiciona em relação à proteção e manutenção da confidencialidade de informações sensíveis ou reservadas?",
                    "Consolidação de parcerias de longo prazo:<br>Como você avalia sua capacidade de estabelecer e manter parcerias baseadas na confiança mútua ao longo do tempo?",
                    "Integridade e reconhecimento:<br>Como você avalia o reconhecimento que recebe em suas relações no que diz respeito à sua integridade - ou seja, à capacidade de “fazer o que eu digo” (walk the talk) - e à postura confiável que adoto?",
                    "Disposição em contribuir sem retribuição imediata:<br>Como você avalia sua disposição para oferecer ajuda e contribuições sem esperar algo em troca imediatamente?",
                    "Receptividade às demandas de ajuda e apoio:<br>Como você avalia sua capacidade de ser receptivo(a) e atender às demandas de ajuda e apoio quando solicitadas?",
                    "Participação ativa em atividades que agregam valor:<br>Como você avalia seu envolvimento em atividades que agregam valor, ou seja, que beneficiam tanto você quanto seus colegas ou a organização?",
                    "Mentoria, incentivo, recomendações e conselhos:<br>Como você avalia sua prática de oferecer mentoria, orientação, incentivo e conselhos para ajudar colegas e parceiros?",
                    "Compartilhamento de insights e fomento a diálogos enriquecedores:<br>Como você avalia sua iniciativa para compartilhar conhecimentos e promover diálogos construtivos que possam enriquecer o ambiente de trabalho?",
                    "Promoção das próprias realizações e habilidades:<br>Como você avalia sua capacidade de promover, de maneira estratégica e natural, suas conquistas e habilidades, fortalecendo sua imagem profissional?",
                    "Participação em eventos e oportunidades de exposição:<br>Como você avalia sua iniciativa em buscar e participar de eventos, palestras, workshops e outras oportunidades que aumentem sua visibilidade profissional?",
                    "Uso de redes sociais e plataformas profissionais:<br>Como você avalia sua capacidade de utilizar redes sociais e plataformas profissionais para divulgar seu trabalho e reforçar sua marca pessoal?",
                    "Demonstração de resultados:<br>Como você avalia sua habilidade de apresentar de forma clara e estruturada os resultados e impactos dos seus projetos e realizações?",
                    "Reconhecimento como referência ou especialista:<br>Como você avalia o reconhecimento que recebe como referência ou especialista em sua área, tanto dentro da sua organização quanto no mercado?"
                ];
                
            } else if (assessmentType === 'ini'){
                sectionConfigs = [
                    { title: "1. RELACIONAMENTO PRÓXIMO", questions: [{}, {}, {}, {}, {}] },
                    { title: "2. CONSTÂNCIA DE FOMENTO", questions: [{}, {}, {}, {}, {}] },
                    { title: "3. ALINHAMENTO DE INTERESSES", questions: [{}, {}, {}, {}, {}] },
                    { title: "4. ATUAÇÃO ESTRATÉGICA", questions: [{}, {}, {}, {}, {}] }
                ];

                questions = [
                    "Participo de projetos interdepartamentais ou colaborações fora da minha área imediata.",
                    "Busco conhecer colegas de diferentes níveis hierárquicos de maneira genuína e respeitosa.",
                    "Demonstro interesse real pelas metas e desafios dos colegas e da empresa.",
                    "Aproveito interações informais (cafés, eventos internos) para fortalecer relações.",
                    "Facilito a integração de pessoas e conhecimentos entre áreas da organização.",
                    "Mantenho contato periódico com colegas, mesmo fora dos projetos em andamento.",
                    "Dou retornos rápidos e atenciosos a comunicações internas.",
                    "Participo de eventos, comitês, grupos ou redes internas da organização.",
                    "Agendo conversas para troca de ideias e atualização profissional.",
                    "Uso canais digitais internos (como chats, intranet, fóruns) para manter relações vivas e produtivas.",
                    "Identifico e crio temas de interesse comum para fortalecer as conexões.",
                    "Compartilho insights, recursos e informações relevantes para os colegas.",
                    "Proponho ou colaboro em projetos de interesse mútuo.",
                    "Apoio ativamente o crescimento profissional dos outros.",
                    "Busco construir relações baseadas em confiança, respeito e reciprocidade (troca genuína).",
                    "Preparo-me estrategicamente para reuniões e interações internas (pesquiso tendências, dados, fornecedores, cases relevantes, etc.).",
                    "Em interações importantes, busco oportunidades de demonstrar conhecimento técnico e visão estratégica de negócio.",
                    "Planejo como posso agregar cada vez mais valor às discussões e projetos, encontrando novas formas de contribuir.",
                    "Aproveito reuniões, eventos e fóruns para evidenciar minha presença e gerar valor e impacto positivo.",
                    "Trato cada interação com pessoas como uma oportunidade de fortalecer minha reputação interna."
                ];
            }

            sectionConfigs.forEach((section, sectionIndex) => {
                const sectionResultDiv = document.createElement("div");
                sectionResultDiv.classList.add("section-result");

                const sectionTitle = document.createElement("h3");
                sectionTitle.innerText = section.title;
                sectionResultDiv.appendChild(sectionTitle);

                const sectionScore = document.createElement("p");
                sectionScore.innerHTML = `<strong>${sectionScores[sectionIndex]} de 20 pontos possíveis</strong>`;
                sectionResultDiv.appendChild(sectionScore);

                // Add section interpretation
                const sectionInterpretation = getSectionInterpretation(section.title, sectionScores[sectionIndex], assessmentType);
                const sectionInterpretationText = document.createElement('p');
                sectionInterpretationText.innerHTML = sectionInterpretation;
                sectionResultDiv.appendChild(sectionInterpretationText);

                // Create and append accordion for questions and answers
                const accordionHTML = createAccordionHTML(section, assessment.answers, sectionIndex, assessmentType, questions);
                sectionResultDiv.innerHTML += accordionHTML;

                sectionResultsDiv.appendChild(sectionResultDiv);
            });
        }

        function getSectionInterpretation(sectionTitle, sectionScore, assessmentType) {
            let interpretation = "";

            if (assessmentType === 'fn') {
                const imrSectionInterpretations = {
                    "1. PROXIMIDADE": {
                        excellent: "<strong>Alta Proximidade</strong>: Você mantém uma <strong>conexão forte e ativa</strong>, investindo tempo e energia para fortalecer esse vínculo. Seu networking não é apenas circunstancial, mas <strong>estrategicamente construído</strong>, seja por meio de interações presenciais frequentes, trocas profundas e sustentação digital. Você demonstra interesse genuíno na relação e tende a ser <strong>proativo na criação de oportunidades de contato</strong>, o que fortalece a conexão. ➡ <strong>Ações recomendadas</strong>: Continue aprofundando essa relação, buscando expandir ainda mais a troca de valor. Explore novas formas de colaboração, como parcerias em projetos, mentorias ou indicações. Se possível, diversifique os canais de contato para aumentar a qualidade da proximidade, integrando interações presenciais e digitais.",
                        good: "<strong>Boa proximidade</strong>: Sua relação apresenta um bom nível de conexão, mas pode haver momentos de distanciamento ou interação mais superficial. Você demonstra interesse e mantém um vínculo ativo, mas há oportunidades para aprofundar as conversas, aumentar a frequência das interações ou equilibrar melhor a reciprocidade da relação. ➡ <strong>Ações recomendadas</strong>: Identifique onde a relação pode ser fortalecida: há pouca interação presencial? O contato digital é esporádico? As conversas são produtivas, mas pouco estratégicas? Pequenos ajustes, como aumentar a regularidade do contato ou buscar interações mais ricas em valor, podem consolidar essa conexão.",
                        average: "<strong>Proximidade Fraca</strong>: A relação existe, mas está distante ou pouco aprofundada. Pode ser uma conexão que teve momentos mais intensos no passado, mas que não foi sustentada ao longo do tempo. Você pode interagir ocasionalmente, mas sem um padrão previsível ou um envolvimento significativo. Se não houver uma ação consciente para reativá-la, a tendência é que esse vínculo se torne cada vez mais fraco. ➡ <strong>Ações recomendadas</strong>: Avalie se essa é uma relação estratégica para você. Caso seja, tome a iniciativa para reacender a conexão - envie uma mensagem, marque um encontro, busque um ponto de interesse comum para retomar o contato. Se perceber que essa relação já não tem mais um propósito relevante, pode ser o momento de redirecionar sua energia para conexões mais ativas.",
                        bad: "<strong>Proximidade Muito Baixa</strong>: Essa conexão é superficial ou praticamente inexistente. Pode ser uma relação circunstancial, baseada apenas em interações casuais ou um contato esporádico sem impacto real. Se não houver um esforço consciente de ambas as partes para fortalecer esse vínculo, ele pode ser irrelevante para seu networking. ➡ <strong>Ações recomendadas</strong>: Reflita sobre o valor dessa relação e se vale a pena investir nela. Caso sim, será necessário reconstruí-la do zero, aumentando a frequência das interações e gerando maior envolvimento. Se a relação parecer forçada ou sem propósito claro, talvez seja mais produtivo dedicar seu tempo a conexões mais significativas."
                    },
                    "2. FREQUÊNCIA": {
                        excellent: "<strong>Alta Frequência</strong>: O contato acontece de maneira consistente e fluida, sem grandes oscilações. Essa relação tem um ritmo estável, o que indica que há um esforço ativo de ambas as partes para manter o vínculo vivo. A constância fortalece a confiança e permite que a conexão gere valor contínuo. Mesmo se houver pausas, elas não afetam negativamente a relação, pois há um padrão claro de interação. ➡ <strong>Ações recomendadas</strong>: Continue cultivando essa consistência e, se possível, aprofunde ainda mais a relação. Diversifique os formatos de contato (presencial, digital, chamadas) para enriquecer a troca. Além disso, aproveite essa estabilidade para construir novas oportunidades de colaboração estratégica.",
                        good: "<strong>Boa Frequência</strong>: A relação é ativa, mas pode haver momentos de menor contato ou períodos mais espaçados de interação. A comunicação ainda ocorre de maneira frequente, mas sem um padrão fixo. Em alguns momentos, a conexão pode parecer forte, enquanto em outros há um distanciamento natural. ➡ <strong>Ações recomendadas</strong>: Busque criar um padrão mais previsível de interação. Pequenos ajustes, como programar encontros regulares ou estabelecer um fluxo de comunicação mais contínuo, podem tornar essa relação ainda mais sólida. Se a relação for estratégica, um esforço intencional para manter a frequência pode evitar que ela perca relevância ao longo do tempo.",
                        average: "<strong>Frequência Irregular</strong>: O contato acontece de forma esporádica, sem consistência. Há períodos em que a relação parece forte e ativa, mas também longos intervalos sem interação, tornando o vínculo instável. Se não houver um esforço consciente, essa conexão pode perder força gradativamente até se tornar irrelevante. ➡ <strong>Ações recomendadas</strong>: Avalie o que tem causado essa irregularidade. O afastamento é por falta de prioridade, tempo ou interesse mútuo? Se essa relação for importante para você, estabeleça um plano para aumentar a frequência dos contatos e evitar que ela esfrie por longos períodos. Se a conexão for mantida apenas por conveniência ou obrigação, talvez seja o momento de repensar sua relevância no seu networking.",
                        bad: "<strong>Baixa Frequência</strong>: A relação praticamente não tem contato e a conexão pode estar se tornando irrelevante. Se não há interação regular e a retomada do contato é difícil, essa conexão pode estar no limbo entre um networking ativo e um vínculo perdido. Relações nessa categoria muitas vezes existem apenas no papel ou na lembrança, sem impacto real no presente. ➡ <strong>Ações recomendadas</strong>: Reflita sobre a importância dessa conexão. Se for uma relação estratégica, será necessário um esforço ativo para reacender esse vínculo - isso pode significar enviar uma mensagem, marcar um encontro ou reestabelecer uma troca de valor. Se perceber que essa relação já não faz sentido para sua trajetória profissional, pode ser melhor concentrar seus esforços em conexões mais significativas."
                    },
                    "3. SINTONIA DE INTERESSES": {
                        excellent: "<strong>Alta Sintonia</strong>: Vocês possuem um forte alinhamento de interesses, valores e objetivos, o que torna essa relação uma conexão estratégica e de grande potencial. Há uma troca contínua de valor, seja por meio de informações, oportunidades ou suporte mútuo. A confiança é alta, permitindo um ambiente de transparência e crescimento conjunto. Além disso, há uma visão de longo prazo para a relação, o que demonstra que essa conexão pode continuar se fortalecendo ao longo do tempo. ➡ <strong>Ações recomendadas</strong>: Continue aprofundando essa relação, aproveitando oportunidades para cocriar, colaborar e expandir esse vínculo. Explore formas de aumentar ainda mais a troca de valor, como parcerias, mentorias ou colaborações estratégicas. Se possível, alinhe expectativas futuras para que essa conexão continue gerando impacto positivo para ambas as partes.",
                        good: "<strong>Boa Sintonia</strong>: Existe um bom nível de alinhamento, mas há aspectos que podem ser aprimorados. Vocês compartilham interesses e objetivos em comum, mas a colaboração pode não ser frequente ou totalmente estruturada. O contato pode ser produtivo, mas há oportunidades para aprofundar a confiança, aumentar o compartilhamento de informações ou definir objetivos mais claros dentro da relação. ➡ <strong>Ações recomendadas</strong>: Identifique quais pontos podem ser fortalecidos. Vocês têm oportunidades de colaboração que ainda não exploraram? Há espaço para maior transparência e confiança? Aprofundar a troca de informações e estabelecer ações concretas pode elevar essa relação para um nível mais estratégico.",
                        average: "<strong>Sintonia Fraca</strong>: A relação tem poucos pontos de conexão, e o alinhamento de valores ou interesses pode ser superficial ou limitado a interações pontuais. Há momentos em que a conexão parece relevante, mas na maior parte do tempo, falta propósito claro para a manutenção dessa relação. A confiança pode não ser suficientemente forte, e a colaboração é rara ou inexistente. ➡ <strong>Ações recomendadas</strong>: Avalie se essa relação tem potencial para ser fortalecida. Se sim, busque formas de criar pontos de interesse comuns - isso pode envolver conversas mais aprofundadas, maior troca de informações ou oportunidades de colaboração. Caso perceba que a relação não se sustenta por falta de afinidade genuína, pode ser mais produtivo concentrar sua energia em conexões mais estratégicas.",
                        bad: "<strong>Baixa Sintonia</strong>: Não há um alinhamento significativo de interesses, valores ou objetivos, e a relação parece mais circunstancial do que estratégica. As interações são casuais e não há um fluxo natural de troca de valor. A conexão pode ter sido útil em algum momento, mas não há indícios de que seja sustentável ou relevante no longo prazo. ➡ <strong>Ações recomendadas</strong>: Reflita sobre a real importância dessa relação para sua rede de contatos. Se não há sintonia ou troca de valor, manter essa conexão pode ser um esforço desnecessário. Considere direcionar seu networking para pessoas com maior alinhamento, que possam agregar mais à sua trajetória e com quem haja uma afinidade natural para colaboração e crescimento mútuo."
                    }
                };

                if (imrSectionInterpretations[sectionTitle]) {
                    if (sectionScore >= 17) {
                        interpretation = imrSectionInterpretations[sectionTitle].excellent;
                    } else if (sectionScore >= 13) {
                        interpretation = imrSectionInterpretations[sectionTitle].good;
                    } else if (sectionScore >= 9) {
                        interpretation = imrSectionInterpretations[sectionTitle].average;
                    } else {
                        interpretation = imrSectionInterpretations[sectionTitle].bad;
                    }
                }
            } else if (assessmentType === 'imp') {
                const impSectionInterpretations = {
                    "1. AGRADABILIDADE": {
                        excellent: "<strong>Excelente</strong>: Você demonstra uma alta capacidade de ser receptivo(a), cordial e empático(a) em suas interações, estabelecendo vínculos com facilidade e criando um ambiente de relacionamento positivo. Ações recomendadas: Mantenha seu comportamento receptivo, diversifique suas interações, lidere conversas construtivas e continue cultivando relacionamentos.",
                        good: "<strong>Bom</strong>: Suas habilidades interpessoais são sólidas, embora haja pequenas variações na consistência da sua receptividade e atenção. Ações recomendadas: Procure aprimorar a escuta ativa e mantenha a abertura em todas as interações, reforçando a consistência no contato com diferentes perfis.",
                        average: "<strong>Oportunidades de Melhoria</strong>: Você apresenta desafios em manter uma postura consistentemente receptiva e atenta, o que pode afetar a qualidade dos vínculos. Ações recomendadas: Invista em treinamentos de comunicação, participe de eventos de networking e pratique técnicas de empatia e escuta ativa para fortalecer suas relações.",
                        bad: "<strong>Necessário Investir Intensamente</strong>: Sua pontuação indica dificuldade significativa em demonstrar receptividade e estabelecer vínculos positivos, prejudicando seu networking. Ações recomendadas: Busque conteúdos, workshops e mentorias focadas em comunicação eficaz e relacionamento interpessoal, e esforce-se para interagir com pessoas fora do seu círculo habitual, adotando novos hábitos de vida."
                    },
                    "2. EXPERTISE": {
                        excellent: "<strong>Excelente</strong>: Você utiliza suas competências de forma consistente para inovar, atingir metas e superar desafios, mantendo-se sempre atualizado(a) e compartilhando conhecimentos de maneira estratégica. Ações recomendadas: Continue investindo em sua atualização e compartilhe seus aprendizados para consolidar sua reputação profissional.",
                        good: "<strong>Bom</strong>: Suas habilidades e conhecimentos são sólidos, mas há oportunidades para uma aplicação mais sistemática e consistente, especialmente no compartilhamento de suas experiências. Ações recomendadas: Fortaleça sua rotina de atualização e organize melhor o compartilhamento dos seus conhecimentos, buscando proativamente feedback para aprimorar suas práticas.",
                        average: "<strong>Oportunidades de Melhoria</strong>: Você apresenta desafios na aplicação regular das suas competências e na busca por atualização, o que impacta o compartilhamento de aprendizados. Ações recomendadas: Participe de cursos e seminários na sua área e estimule trocas de experiências com colegas para elevar sua prática profissional.",
                        bad: "<strong>Necessário Investir Intensamente</strong>: Sua pontuação indica dificuldades significativas em aplicar suas habilidades de forma consistente, com pouca iniciativa para atualização e compartilhamento. Ações recomendadas: Invista fortemente em autodesenvolvimento por meio de treinamentos, mentorias e leituras especializadas para construir uma base sólida e aplicá-la regularmente."
                    },
                    "3. CONFIANÇA": {
                        excellent: "<strong>Excelente</strong>: Você demonstra ser altamente confiável, alinhando suas palavras e ações com transparência e integridade, o que se reflete em relacionamentos sólidos e no cumprimento consistente de seus compromissos. Ações recomendadas: Mantenha essa postura exemplar e continue buscando feedback para aperfeiçoar ainda mais sua integridade e consistência.",
                        good: "<strong>Bom</strong>: Sua postura é geralmente íntegra e consistente, embora existam oportunidades para aumentar a transparência em situações desafiadoras. Ações recomendadas: Trabalhe para alinhar ainda mais suas ações com seu discurso, solicitando feedback de colegas e aprimorando sua comunicação nos momentos difíceis.",
                        average: "<strong>Oportunidades de Melhoria</strong>: Você enfrenta desafios para manter uma postura íntegra e consistente, o que impacta a percepção de sua confiabilidade. Ações recomendadas: Invista em estratégias para fortalecer sua comunicação e ética profissional, buscando novos hábitos que ajudem a alinhar seus compromissos com suas ações.",
                        bad: "<strong>Necessário Investir Intensamente</strong>: Sua pontuação sugere dificuldades significativas em demonstrar confiabilidade e integridade, prejudicando seus relacionamentos e parcerias. Ações recomendadas: Dedique-se a desenvolver a transparência e a consistência, participando de treinamentos em ética e integridade e solicitando feedback regular para ajustar seu comportamento."
                    },
                    "4. COLABORAÇÃO": {
                        excellent: "<strong>Excelente</strong>: Você se destaca pela disposição em contribuir de forma espontânea e pelo engajamento ativo em iniciativas que agregam valor ao coletivo, fortalecendo parcerias e relações de trabalho. Ações recomendadas: Continue se envolvendo em atividades de grupo e incentivando a troca de conhecimentos, reforçando sua influência positiva no ambiente profissional.",
                        good: "<strong>Bom</strong>: Sua colaboração é consistente, mas há momentos em que um engajamento mais proativo pode beneficiar ainda mais o coletivo. Ações recomendadas: Busque participar mais ativamente de projetos de equipe e ofereça apoio de forma mais desinteressada para ampliar sua rede de alianças.",
                        average: "<strong>Oportunidades de Melhoria</strong>: Você apresenta desafios em oferecer ajuda de forma espontânea e em engajar-se ativamente, o que pode limitar a formação de vínculos sólidos. Ações recomendadas: Participe de projetos colaborativos, pratique oferecer ajuda sem esperar retorno e solicite feedback sobre sua postura colaborativa.",
                        bad: "<strong>Necessário Investir Intensamente</strong>: Sua pontuação indica dificuldades significativas em colaborar sem esperar algo em troca, comprometendo o desenvolvimento de parcerias e a percepção de seu valor no grupo. Ações recomendadas: Invista em atividades de grupo, busque trocar sobre colaboração com outras pessoas e desenvolva uma mentalidade de contribuir primeiro para fortalecer sua rede."
                    },
                    "5. VISIBILIDADE": {
                        excellent: "<strong>Excelente</strong>: Você promove suas conquistas e habilidades de forma estratégica e natural, utilizando eventos, redes sociais e outras ferramentas para ampliar sua presença e consolidar sua marca pessoal. Ações recomendadas: Continue ampliando sua visibilidade e explore novas oportunidades de autopromoção e networking para expandir sua influência.",
                        good: "<strong>Bom</strong>: Sua capacidade de divulgação é boa, mas pode ser aprimorada com uma abordagem mais sistemática e regular, tanto em eventos quanto nas redes sociais. Ações recomendadas: Atualize seus perfis com maior frequência e planeje sua participação em eventos e publicações para fortalecer sua presença no mercado.",
                        average: "<strong>Oportunidades de Melhoria</strong>: Você apresenta desafios em oferecer ajuda de forma espontânea e em engajar-se ativamente, o que pode limitar a formação de vínculos sólidos. Ações recomendadas: Invista em estratégias de autopromoção, atualize regularmente seus canais digitais e participe ativamente de oportunidades para compartilhar seus resultados.",
                        bad: "<strong>Necessário Investir Intensamente</strong>: Sua pontuação revela dificuldades em tornar seu trabalho conhecido, prejudicando o reconhecimento de suas competências e limitando oportunidades de crescimento. Ações recomendadas: Dedique-se a desenvolver sua marca pessoal, mantendo perfis profissionais atualizados, participando de eventos relevantes e buscando oportunidades para falar sobre seus projetos e conquistas."
                    }
                };

                if (impSectionInterpretations[sectionTitle]) {
                    if (sectionScore >= 17) {
                        interpretation = impSectionInterpretations[sectionTitle].excellent;
                    } else if (sectionScore >= 13) {
                        interpretation = impSectionInterpretations[sectionTitle].good;
                    } else if (sectionScore >= 9) {
                        interpretation = impSectionInterpretations[sectionTitle].average;
                    } else {
                        interpretation = impSectionInterpretations[sectionTitle].bad;
                    }
                }
            }

            return interpretation;
        }

        function createAccordionHTML(section, answers, sectionIndex, assessmentType, questions) {
            let accordionHTML = `
                <details class="accordion">
                    <summary>${section.title} - Respostas</summary>
                    <div class="accordion-content">
            `;

            for (let i = 0; i < section.questions.length; i++) {
                const questionIndex = sectionIndex * section.questions.length + i;
                const answer = answers.find(ans => ans.questionIndex === questionIndex);
                let answerText = "Resposta não encontrada";

                if (answer) {
                    let options = [];
                    if (assessmentType === 'fn') {
                       options = ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"];
                    } else if (assessmentType === 'imp') {
                         options = ["Sempre", "Frequentemente", "Ocasionalmente", "Raramente"];
                    }
                    answerText = options[answer.answerIndex] || "Opção não encontrada";
                }

                const questionText = questions[questionIndex] || `Questão ${questionIndex + 1} não encontrada`;

                accordionHTML += `
                        <div class="question-answer">
                            <p><strong>${i + 1}. ${questionText}</strong></p>
                            <p><em>Resposta: ${answerText}</em></p>
                        </div>
                `;
            }

            accordionHTML += `
                    </div>
                </details>
            `;

            return accordionHTML;
        }
    </script>
</body>

</html>